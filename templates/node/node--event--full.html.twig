{{ drupal_entity('block', 'yalesitesbreadcrumbs', check_access=false) }}

{#
  Please make this backend.  ;)
  Is it worth me making this a hook?
#}
{# 
  The duration that is set when you select "all day" 

  This is done because smart date is not exposing to node whether you selected
  all day or not
#}
{% set all_day_duration = 1439 %}

{#
  Since each all day day adds an extra minute, we create a delta based on the
  number of days selected
#}
{% set delta = (node.field_event_date.duration // all_day_duration) %}

{% embed "@molecules/page-title/yds-page-title.twig" with {
  page_title__heading: label,
  page_title__width: 'content',
} %}
  {% block page_title__meta %}
    {% set cal_link = calendar_link('ics', 'title', date(), date(), event_meta__all_day, 'description', 'location') %}
    {% set event_meta__all_day = (node.field_event_date.duration % all_day_duration) <= delta %}
    {% include "@molecules/meta/event-meta/yds-event-meta.twig" with {
      event_meta__date_start: node.field_event_date.value,
      event_meta__date_end: node.field_event_date.end_value,
      event_meta__format: node.field_event_format.value,
      event_meta__address: nothing_yet,
      event_meta__cta_primary__content: node.field_event_cta.title,
      event_meta__cta_primary__href: node.field_event_cta.uri,
      event_meta__cta_secondary__content: 'Add to Calendar',
      event_meta__cta_secondary__href: cal_link,
    } %}
  {% endblock %}
{% endembed %}

{{ content|without('field_event_date', 'field_event_format', 'field_event_cta') }}
